<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>Pokemon</title>
  </head>
  <body>
    
    <div class="container">

        <div id="titulo">
            <h1 class="p-3 mb-2 bg-info text-white">Listado de personas</h1>
        </div>

        <div class="row">
          <div class="col" id="listaCompleta">
            <ul id="pokemons" class="list-group">
                <li id="pokemon" class="list-group-item">Cargando...</li>
                <p><button id="boton" type="button" class="btn btn-success">Mas</button></p>
            </ul>
          </div>

          <div class="col">
            <p id="poke">Cargando...</p>
          </div>
        </div>
    </div>


    <script>
        window.addEventListener('load', init() );

        function init(){

            const url = 'https://pokeapi.co/api/v2/pokemon';
            var urlNombre = '';
            //creamos un objeto para realizar la REQUEST con ajax
            var xhttp = new XMLHttpRequest();
            var xhttp2 = new XMLHttpRequest();

            //PONER CODIGO DENTRO
            xhttp.onreadystatechange = function() {
                // recibimos la RESPONSE
                if (this.readyState == 4 && this.status == 200) {
                    console.debug( this.responseText );

                    // parsear texto a Json
                    const jsonData = JSON.parse(this.responseText);    
                    console.debug( jsonData );

                    // array con pokemons
                    const pokemons = jsonData.results;

                    let lista = document.getElementById('listaCompleta');
                    lista.innerHTML = '';

                    for(let i=0; i < pokemons.length; i++ ){
                        const pokemon = pokemons[i];
                        
                        lista.innerHTML += `<li id="pokemon" class="list-group-item">
                                                <p id="pokemonNombre"><b>${pokemon.name}</b></p>
                                                <p><button id="boton" type="button" class="btn btn-success">Mas</button></p>
                                            </li>`;

                    }

                    let elBoton = document.getElementById('boton');
                    elBoton.addEventListener('click', detalle);

                    function hola(){
                        let poke = document.getElementById('poke');
                        poke.innerHTML = 'Hola';
                    }

                    function detalle(){
                        
                        let pokemon1 = document.getElementById('pokemonNombre');
                        let poke = document.getElementById('poke');
                        poke.innerHTML = 'Hola: ' + pokemon1.innerText;

                        /*urlNombre = 'https://pokeapi.co/api/v2/pokemon/' + pokemon1.innerText;
                        const jsonDataNombre = JSON.parse(this.responseText);    
                        console.debug( jsonDataNombre );*/

                        /*xhttp2.open("GET", urlNombre , true);
                        xhttp2.send();
                        console.debug(xhttp2.send());*/
                    }

                }// his.readyState == 4 && this.status == 200


            };// onreadystatechange

            // preparamos la petici√≥n GET
            xhttp.open("GET", url , true);
            xhttp2.open("GET", urlNombre , true);
            // enviar la peticion asincrona, meter el codigo en onreadystatechange
            xhttp.send();
            xhttp2.send();


        } 
    </script>

    
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>